{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Syed Mohdin\\\\Desktop\\\\jmibook\\\\client\\\\src\\\\components\\\\dashboard\\\\post\\\\AddPost.js\";\nimport React, { Component } from 'react';\nimport { connect } from 'react-redux';\nimport { addFPost } from '../../../actions/postActions';\nimport firebase from '../../firebase/firebase';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nclass AddPost extends Component {\n  constructor(...args) {\n    super(...args);\n    this.state = {\n      myImage: '',\n      discp: '',\n      msg: null,\n      loading: null\n    };\n\n    this.onChange = e => {\n      this.setState({\n        myImage: e.target.files[0]\n      });\n      console.log(e.target.files[0]);\n      this.setState({\n        msg: null\n      });\n    };\n\n    this.onTextChange = e => {\n      this.setState({\n        discp: e.target.value\n      });\n      this.setState({\n        msg: null\n      });\n    };\n\n    this.onSubmit = e => {\n      e.preventDefault(); // console.log('submitting')\n      // const formData = new FormData();\n      // formData.append('user_id', this.props.user._id);\n      // formData.append('fname', this.props.user.fname);\n      // formData.append('lname', this.props.user.lname);\n      // formData.append('user_img', this.props.user.profile_imgsrc);\n      // formData.append('discp', this.state.discp);\n      // formData.append('myImage', this.state.myImage);\n\n      if (!this.state.discp.trim() || !this.state.myImage) {\n        this.setState({\n          msg: 'Please enter all fields.'\n        });\n      } else {\n        let bucketName = 'images';\n        let file = this.state.myImage;\n        let storageRef = firebase.storage().ref(`${bucketName}/${file.name}`);\n        let uploadTask = storageRef.put(file);\n        uploadTask.on('state_changed', snapshot => {\n          console.log(\"Image Upload Progress\");\n          this.setState({\n            loading: 'Uploading...'\n          });\n        }, error => {\n          console.log(error);\n        }, () => {\n          uploadTask.snapshot.ref.getDownloadURL().then(downloadURL => {\n            console.log(downloadURL);\n            const post = {\n              user_id: this.props.user._id,\n              fname: this.props.user.fname,\n              lname: this.props.user.lname,\n              user_img: this.props.user.profile_imgsrc,\n              discp: this.state.discp,\n              myImageURL: downloadURL\n            };\n            e.target.reset();\n            this.props.addFPost(post);\n          }).then(asd => {\n            console.log(asd);\n          });\n        });\n      }\n    };\n  }\n\n  componentDidUpdate(prevProps) {\n    if (prevProps.post != this.props.post) {\n      if (this.props.post) {\n        this.setState({\n          myImage: null\n        });\n        this.setState({\n          discp: ''\n        });\n        this.setState({\n          loading: null\n        });\n        this.setState({\n          loading: null\n        });\n      }\n    }\n  }\n\n  render() {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        class: \"create-post\",\n        children: [/*#__PURE__*/_jsxDEV(\"center\", {\n          children: /*#__PURE__*/_jsxDEV(\"p\", {\n            style: {\n              color: 'red'\n            },\n            children: /*#__PURE__*/_jsxDEV(\"b\", {\n              children: this.state.msg\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 90,\n              columnNumber: 50\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 90,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 90,\n          columnNumber: 17\n        }, this), /*#__PURE__*/_jsxDEV(\"center\", {\n          children: /*#__PURE__*/_jsxDEV(\"p\", {\n            style: {\n              color: 'green'\n            },\n            children: /*#__PURE__*/_jsxDEV(\"b\", {\n              children: this.state.loading\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 91,\n              columnNumber: 52\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 91,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 91,\n          columnNumber: 17\n        }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n          method: \"post\",\n          onSubmit: this.onSubmit,\n          children: [/*#__PURE__*/_jsxDEV(\"img\", {\n            src: \"images/Anonymous.jpg\",\n            class: \"user-create-post\",\n            alt: \"\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 93,\n            columnNumber: 21\n          }, this), /*#__PURE__*/_jsxDEV(\"textarea\", {\n            name: \"create\",\n            id: \"textarea\",\n            placeholder: \"Share Something with the community\",\n            cols: \"50\",\n            rows: \"2\",\n            onChange: this.onTextChange,\n            value: this.state.discp\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 94,\n            columnNumber: 21\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"file\",\n            class: \"file-input\",\n            id: \"file-choose\",\n            class: \"extreme-right\",\n            name: \"myImage\",\n            onChange: this.onChange // value={this.state.myImage}\n            // ref={this.state.myImage}\n\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 103,\n            columnNumber: 21\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            type: \"submit\",\n            class: \"submit-button\",\n            children: \"Post\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 127,\n            columnNumber: 21\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 92,\n          columnNumber: 17\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 89,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 88,\n      columnNumber: 13\n    }, this);\n  }\n\n}\n\nconst mapStateToProps = state => ({\n  user: state.auth.user,\n  post: state.post.item\n});\n\nexport default connect(mapStateToProps, {\n  addFPost\n})(AddPost); // export default AddPost;","map":{"version":3,"sources":["C:/Users/Syed Mohdin/Desktop/jmibook/client/src/components/dashboard/post/AddPost.js"],"names":["React","Component","connect","addFPost","firebase","AddPost","state","myImage","discp","msg","loading","onChange","e","setState","target","files","console","log","onTextChange","value","onSubmit","preventDefault","trim","bucketName","file","storageRef","storage","ref","name","uploadTask","put","on","snapshot","error","getDownloadURL","then","downloadURL","post","user_id","props","user","_id","fname","lname","user_img","profile_imgsrc","myImageURL","reset","asd","componentDidUpdate","prevProps","render","color","mapStateToProps","auth","item"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\r\nimport { connect } from 'react-redux';\r\nimport { addFPost } from '../../../actions/postActions';\r\nimport firebase from '../../firebase/firebase'\r\n\r\nclass AddPost extends Component {\r\n\r\n    state={\r\n        myImage:'',\r\n        discp:'',\r\n        msg:null,\r\n        loading:null,\r\n    }\r\n\r\n    onChange = (e) => {\r\n        this.setState({ myImage:e.target.files[0] })\r\n        console.log(e.target.files[0])\r\n        this.setState({ msg:null })\r\n    }\r\n\r\n    onTextChange = (e) => {\r\n        this.setState({ discp:e.target.value })\r\n        this.setState({ msg:null })\r\n    }\r\n\r\n//  async\r\n    onSubmit = e => {\r\n        e.preventDefault();\r\n        // console.log('submitting')\r\n        // const formData = new FormData();\r\n        \r\n        // formData.append('user_id', this.props.user._id);\r\n        // formData.append('fname', this.props.user.fname);\r\n        // formData.append('lname', this.props.user.lname);\r\n        // formData.append('user_img', this.props.user.profile_imgsrc);\r\n        // formData.append('discp', this.state.discp);\r\n        // formData.append('myImage', this.state.myImage);\r\n\r\n        if(!this.state.discp.trim() || !this.state.myImage){\r\n            this.setState({msg:'Please enter all fields.'})\r\n        }else{\r\n\r\n            let bucketName = 'images';\r\n            let file = this.state.myImage;\r\n            let storageRef = firebase.storage().ref(`${bucketName}/${file.name}`)\r\n            let uploadTask = storageRef.put(file)\r\n            uploadTask.on('state_changed', (snapshot) => {\r\n              console.log(\"Image Upload Progress\")\r\n              this.setState({loading:'Uploading...'})\r\n              },\r\n              (error) => {\r\n                  console.log(error);\r\n              },\r\n              () => {\r\n                uploadTask.snapshot.ref.getDownloadURL().then(downloadURL => {\r\n                console.log(downloadURL)\r\n                const post = {\r\n                    user_id: this.props.user._id,\r\n                    fname: this.props.user.fname,\r\n                    lname: this.props.user.lname,\r\n                    user_img: this.props.user.profile_imgsrc,\r\n                    discp: this.state.discp,\r\n                    myImageURL: downloadURL,\r\n                }\r\n                e.target.reset();\r\n                this.props.addFPost(post);\r\n                }).then(asd=>{\r\n                  console.log(asd)\r\n                })\r\n              }\r\n            )\r\n        }\r\n    }\r\n\r\n    componentDidUpdate(prevProps){\r\n        if(prevProps.post != this.props.post){\r\n            if(this.props.post){\r\n                this.setState({myImage:null})\r\n                this.setState({ discp:'' })\r\n                this.setState({ loading:null })\r\n                this.setState({ loading:null })\r\n            }\r\n        }\r\n    }\r\n\r\n    render() {\r\n        return (\r\n            <div>\r\n                <div class=\"create-post\">\r\n                <center><p style={{color:'red'}}><b>{this.state.msg}</b></p></center>\r\n                <center><p style={{color:'green'}}><b>{this.state.loading}</b></p></center>\r\n                <form method='post' onSubmit={this.onSubmit}>\r\n                    <img src=\"images/Anonymous.jpg\" class=\"user-create-post\" alt=\"\"/>\r\n                    <textarea \r\n                        name=\"create\" \r\n                        id=\"textarea\" \r\n                        placeholder=\"Share Something with the community\" \r\n                        cols=\"50\" \r\n                        rows=\"2\"\r\n                        onChange={this.onTextChange}\r\n                        value={this.state.discp}\r\n                    />    \r\n                    <input\r\n                        type=\"file\"\r\n                        class=\"file-input\"\r\n                        id=\"file-choose\" \r\n                        class=\"extreme-right\"\r\n                        name=\"myImage\"\r\n                        onChange={this.onChange}\r\n                        // value={this.state.myImage}\r\n                        // ref={this.state.myImage}\r\n                    />\r\n                    {/* <label for=\"file-choose\" class=\"svg-pos\"/> */}\r\n                    {/* <table class=\"extreme-right\">\r\n                        <tr>\r\n                            <td>\r\n                                <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"40px\" height=\"40px\" fill=\"currentColor\" class=\"bi bi-image\" viewBox=\"0 0 16 16\">\r\n                                <path d=\"M6.002 5.5a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0z\"/>\r\n                                <path d=\"M2.002 1a2 2 0 0 0-2 2v10a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V3a2 2 0 0 0-2-2h-12zm12 1a1 1 0 0 1 1 1v6.5l-3.777-1.947a.5.5 0 0 0-.577.093l-3.71 3.71-2.66-1.772a.5.5 0 0 0-.63.062L1.002 12V3a1 1 0 0 1 1-1h12z\"/>\r\n                                </svg>\r\n                            </td>\r\n                        </tr>\r\n                        <tr>\r\n                            <td><button type=\"submit\" class=\"submit-button\">Post</button></td>\r\n                        </tr>\r\n                    </table> */}\r\n                    <button type=\"submit\" class=\"submit-button\">Post</button>\r\n                    </form>\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n}\r\n\r\nconst mapStateToProps = state => ({\r\n    user:state.auth.user,\r\n    post:state.post.item,\r\n});\r\n\r\nexport default connect(mapStateToProps, { addFPost })(AddPost);\r\n// export default AddPost;"]},"metadata":{},"sourceType":"module"}